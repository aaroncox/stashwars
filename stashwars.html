<head>

  <meta charset="utf-8">
  <title>StashWars - Fast Paced Auctions for Diablo 3</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Le styles -->
  <style>
    body {
      padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
    }
  </style>

  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <!-- Fav and touch icons -->
  <link rel="shortcut icon" href="/img/favicon.ico">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/apple-touch-icon-114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/apple-touch-icon-72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" href="/img/apple-touch-icon-57-precomposed.png">
</head>

<body>
  <div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container-fluid">
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
        {{> nav}}
      </div>
    </div>
  </div>

  <div class="container-fluid">
    <div class="row-fluid">
      {{> page}}
    </div>
  </div> <!-- /container -->

  <!-- Le javascript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->

  <!-- Clicky Analytics Code -->
  <script src="//static.getclicky.com/js" type="text/javascript"></script>
  <script type="text/javascript">try{ clicky.init(100556930); }catch(e){}</script>
  <noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/100556930ns.gif" /></p></noscript>

</body>

<template name="page">
	{{> index}}
	{{> auction_list}}
	{{> bids_page}}
	{{> create_dialog}}
	{{> auction_page}}
</template>

<template name="bids_page">
	{{#if show}}
	<h4>Recent Bids</h4>
	<table class="table">
		<thead>
			<tr>
				<th>Amount</th>
				<th>Bidder</th>
				<th>Auction</th>
				<th>Time</th>
			</tr>
		</thead>
		<tbody>
			{{#each bids}}
			<tr>
				<td align="right">{{money value}}</td>
				<td>{{ownerName}}</td>
				<td><a class="local" href="/auction/{{auction}}">{{auctionTitle auction}}</a></td>
				<td>{{timeago time}}</td>
			{{/each}}
		</tbody>
	</table>
	{{/if}}
</template>

<template name="index">
	{{#if show}}
	<h1>Welcome to StashWars.com</h1>
	<p>Click on <a href="/auctions" class="local">auctions</a> to find the useful stuff.</p>
	{{/if}}
</template>

<template name="nav">
	<a class="brand local" href="/">StashWars</a>
  <div class="nav-collapse collapse">
    <p class="navbar-text pull-right">
      <button class="btn create">Create Auction</button>
      {{loginButtons}}
    </p>
    <ul class="nav">
			<li><a class="local" href="/auctions">Auctions</a></li>
			<li><a class="local" href="/bids">Bids</a></li>
			{{#if auction}}
			<li><a class="local" href="/auction/{{auction._id}}">{{auction.title}}</a></li>
			{{/if}}
    </ul>
  </div><!--/.nav-collapse -->
</template>

<template name="auction_page">
	{{#if show}}
	  <div class="span4">
			<h1>{{auction.title}}</h1>
			<h3>Current Bid: {{money auction.price}} by {{auction.highestBidder}}</h3>
			<form class="bid">
				{{#if error}}
				<div class="alert alert-error">{{error}}</div>
				{{/if}}
				<input type="text" name="bid" value="0">
				<input type="submit" class="btn" value="Bid">
			</form>
			{{> auction_page_bid_info}}
	  </div>
	  <div class="span8">
			{{> auction_editor}}
	  </div>
	{{/if}}
</template>

<template name="auction_page_bid_info">
	<h5># of Bids: {{auction.bids}}</h5>
	<h5>Last Bid: {{timeago auction.last_bid}}</h5>
	<ul>
	{{#each bids}}
		<li>{{money value}} by {{ownerName}}</li>
	{{/each}}
	</ul>
</template>

<template name="auction_list">
  {{#if show}}
    <div class="auction_list">
      <h4>Auctions</h4>
      <table class="table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Owner</th>
            <th>Current Bid</th>
            <th>Current Bidder</th>
            <th># of Bids</th>
            <th>Last Bid</th>
          </tr>
        </thead>
        <tbody>
          {{#each all}}
            {{> auction_row}}
          {{/each}}
        </tbody>
      </table>
    </div>
  {{/if}}
</template>

<template name="auction_row">
  <tr class="auction {{is_selected}}">
    <td><a class="local" href="/auction/{{_id}}" class="title">{{title}}</span></td>
    <td>{{ownerName}}</td>
    <td>{{money price}}</td>
    <td>{{highestBidder}}</td>
    <td>{{bids}}</td>
    <td>{{timeago last_bid}}</td>
  </tr>
</template>

<template name="create_dialog">
  {{#if show}}
  <div class="mask"> </div>
  <div class="modal">
    <div class="modal-header btn-primary">
      <button type="button" class="close cancel">&times;</button>
      <h3>Create an Auction</h3>
    </div>

    <div class="modal-body">
      {{#if error}}
        <div class="alert alert-error">{{error}}</div>
      {{/if}}
			<p>The first few pieces of information we need are a title for the auction, as well as how long you're going to be around to complete the transaction.</p>
      <label>Descriptive Title</label>
			<input type="text" class="title span5">
			<label>Type of Auction</label>
			<select class="type">
				<option value="unid">Unidentified Items Auction</option>
			</select>
			<label>Length of Auction</label>
			<select class="duration">
				<option value="60">60 Minutes</option>
				<option value="30">30 Minutes</option>
				<option value="15">15 Minutes</option>
			</select>
			<h4>Next Steps...</h4>
			<p>Clicking "Create" will not automatically start your auction. On the next screen, you will configure exactly what is part of this auction and any other options.</p>
    </div>

    <div class="modal-footer">
      <button class="btn cancel">Cancel</button>
      <button class="btn btn-primary save">Create</button>
    </div>
  </div>
  {{/if}}
</template>

<template name="auction_editor">
	{{#if isOwner}}
	<div class="alert alert-info">
		<form>
			<fieldset>
				<legend>Auction Controls</legend>
				<div class="row-fluid">
				  <div class="span4">
				    <label>Pick an Unidentified Item...</label>
						{{> item_select}}		  					  	
				  </div>
				  <div class="span4">
				    <label>and pick how many...</label>
						<input type="text" placeholder="Quantity">
				  </div>
				  <div class="span4">
						<span class="help-block">Add Xx ITEM_NAME to the auction.</span>
				    <button type="submit" class="btn btn-success">Add Items</button>				  	
				  </div>
				</div>
		  </fieldset>
		</form>
	</div>
	{{/if}}
</template>

<template name="item_select">
	<select name="item" class="select">
		{{#key_value items}}
			<option value="{{key}}">{{value}}</option>
		{{/key_value}}
	</select>
</template>
